(function(n){function t(){function d(t){var u={t:"transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",a:"webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend"},r=".fg-date.fg-picker-focus",i;i=k?{i:"touchstart",m:"touchmove",e:"touchend"}:{i:"mousedown",m:"mousemove",e:"mouseup"};n(document)[t]("click",et);n(document)[t](u.a,r+".fg-picker-rmbl",ot);n(document)[t](u.t,".fg-date-modal-overlay",st);n(document)[t](i.i,r+" .pick-lg li.pick-v",ht);n(document)[t]("click",r+" .pick-btn-sz",ct);n(document)[t](i.i,r+" .pick-arw.pick-arw-s2",lt);n(document)[t](i.i,r+" .pick-arw.pick-arw-s1",at);n(document)[t](i.i,r+" ul.pick.pick-y li",vt);n(document)[t](i.e,r+" ul.pick.pick-y li",yt);n(document)[t](i.i,r+" ul.pick.pick-d li",pt);n(document)[t](i.e,r+" ul.pick.pick-d li",wt);n(document)[t](i.i,r+" ul.pick",bt);n(document)[t](i.m,kt);n(document)[t](i.e,dt);n(document)[t](i.i,r+" .pick-submit",gt);n(window)[t]("resize",ni)}function et(n){u||t.$elem.is(n.target)||i.is(n.target)||i.has(n.target).length!==0||(g(),u=null)}function ot(){i.hasClass("fg-picker-rmbl")&&n(this).removeClass("fg-picker-rmbl")}function st(){n(this).remove()}function ht(){i.find(".pick-lg-b li").removeClass("pick-sl");n(this).addClass("pick-sl");r.date(n(this).attr("data-value"));h("d",n(this).attr("data-value"))}function ct(){rt()}function lt(i){i.preventDefault();u=null;var o=n(this).closest("ul").data("k"),e=r.year()+t.options.jump*(n(this).hasClass("pick-arw-r")?1:-1),f=ft("y",t.options.jump);e>f[f.length-1]&&(e=f[0]);e<f[0]&&(e=f[f.length-1]);r.year(e);h("y",r.year())}function at(t){t.preventDefault();u=null;var i=n(this).closest("ul").data("k");it(i,n(this).hasClass("pick-arw-r")?1:-1)}function vt(){o=!0}function yt(){if(o){n(this).closest("ul").toggleClass("pick-jump");var t=fi(r.year(),ft("y",jump));r.year(t);h("y",r.year());o=!1}}function pt(){o=!0}function wt(){o&&(rt(),o=!1)}function bt(t){var i=n(this);i&&(u={el:i,k:i.data("k"),offset:k?t.originalEvent.touches[0].pageY:t.pageY,d:r.date(),m:r.month(),y:r.year()},u.init=s(u.k))}function kt(n){if(o=!1,u){n.preventDefault();var t=k?n.originalEvent.touches[0].pageY:n.pageY;t=Math.round((u.offset-t)*.026);r.set({year:u.y,month:u.m,date:u.d});it(u.k,t)}}function dt(){u&&setTimeout(function(){u=null},100)}function gt(){f=r;g();y(!0)}function ni(){nt();ut()}function ti(){r=f.clone();ii();ut();nt();i.hasClass("fg-picker-lg")&&l();tt();i.addClass("fg-picker-focus");i.hasClass("fg-date-modal")&&n("body").append('<div class="fg-date-modal-overlay"><\/div>')}function g(){ui()&&(n(".fg-date-modal-overlay").remove(),d("off"),i.remove(),i=null)}function ii(){var f,u,e;if(i=n("<div>").addClass("fg-date").addClass(t.options.theme||"primary").appendTo("body"),t.options.modal&&i.addClass("fg-date-modal"),t.options.fx&&i.addClass("fg-picker-fxs"),v()[0]!=="s"&&i.addClass("fg-picker-lg"),f=n("<div>").addClass("fg-picker").appendTo(i),t.options.modal&&t.options.title&&n("<div>").addClass("fg-date-title").text(t.options.title).appendTo(i),["m","d","y"].forEach(function(t){n("<ul>").addClass("pick pick-"+t).attr("data-k",t).appendTo(f);ri(t)}),v().indexOf("l")>=0){var o=n("<div>").addClass("pick-lg").insertBefore(i.find(".pick-d")),s=n("<ul>").addClass("pick-lg-h").appendTo(o),h=n("<ul>").addClass("pick-lg-b").appendTo(o),c=r.clone();for(u=0;u<7;u++)n("<li>").text(r.localeData().weekdaysShort(c.weekday(u))).appendTo(s);for(u=0;u<42;u++)n("<li>").appendTo(h)}e=n("<div>").addClass("pick-btns").appendTo(f);n("<div>").addClass("pick-submit").appendTo(e);v().indexOf("l")>=0&&n("<div>").addClass("pick-btn pick-btn-sz").appendTo(e);d("on")}function nt(){if(!i.hasClass("fg-date-modal")){var n=t.$elem.offset().left+t.$elem.outerWidth()/2,r=t.$elem.offset().top+t.$elem.outerHeight();i.css({left:n,top:r})}}function ri(t){for(var o,c,l=i.hasClass("fg-picker-lg")?"months":"monthsShort",u=a(t),f=e[t].min;f<=e[t].max;f++){o=f;switch(t){case"d":o+="<span><\/span>";break;case"m":o=r.localeData()[l](moment({month:f-1}))}n("<li>",{value:f,html:o}).appendTo(u)}c=n("<div>").addClass("pick-arw pick-arw-s1 pick-arw-l").appendTo(u);n("<i>").addClass("pick-i-l").appendTo(c);n("<div>",{"class":"pick-arw pick-arw-s1 pick-arw-r",html:n("<i>",{"class":"pick-i-r"})}).appendTo(u);t==="y"&&(n("<div>",{"class":"pick-arw pick-arw-s2 pick-arw-l",html:n("<i>",{"class":"pick-i-l"})}).appendTo(u),n("<div>",{"class":"pick-arw pick-arw-s2 pick-arw-r",html:n("<i>",{"class":"pick-i-r"})}).appendTo(u));h(t,s(t))}function l(){var u=i.find(".pick-lg-b");u.find("li").empty().removeClass("pick-n pick-b pick-a pick-v pick-lk pick-sl pick-h").attr("data-value","");var t=0,n=r.clone().startOf("month"),f=n.month();if(n.weekday()!==0){while(n.weekday()!==0)n.add(-1,"d");while(n.date()!==1)u.find("li").eq(t).text(n.date()).addClass("pick-b pick-n pick-h"),n.add(1,"d"),t++}while(n.month()===f)u.find("li").eq(t).text(n.date()).addClass("pick-n pick-v").attr("data-value",n.date()),n.add(1,"d"),t++;while(t<42)u.find("li").eq(t).text(n.date()).addClass("pick-a pick-n pick-h"),n.add(1,"d"),t++;i.find(".pick-lg-b li.pick-v[data-value="+s("d")+"]").addClass("pick-sl")}function tt(){var t=s("m"),u=s("y");e.d.max=r.daysInMonth();i.find(".pick-d li").removeClass("pick-wke").each(function(){var i=new Date(t+"/"+n(this).attr("value")+"/"+u),f=i.getDay();n(this).find("span").html(r.localeData().weekdays(moment(i)));(f===0||f===6)&&n(this).addClass("pick-wke")});i.hasClass("fg-picker-lg")&&(i.find(".pick-lg-b li").removeClass("pick-wke"),i.find(".pick-lg-b li.pick-v").each(function(){var r=new Date(t+"/"+n(this).attr("data-value")+"/"+u),i=r.getDay();(i==0||i==6)&&n(this).addClass("pick-wke")}))}function h(n,t){var r=a(n),u;r.find("li").removeClass("pick-sl pick-bfr pick-afr");t===c(n,"last")&&(u=r.find('li[value="'+c(n,"first")+'"]'),u.clone().insertAfter(r.find("li[value="+t+"]")),u.remove());t===c(n,"first")&&(u=r.find('li[value="'+c(n,"last")+'"]'),u.clone().insertBefore(r.find("li[value="+t+"]")),u.remove());r.find("li[value="+t+"]").addClass("pick-sl");r.find("li.pick-sl").nextAll("li").addClass("pick-afr");r.find("li.pick-sl").prevAll("li").addClass("pick-bfr");p||(p=setTimeout(function(){i.hasClass("fg-picker-lg")&&l();tt();p=null},200))}function it(n,t){var u=n==="m"?"M":n,i=r.clone();i.add(t,u);i=moment.max(i,w.clone());r=moment.min(i,b.clone());["d","m","y"].forEach(function(n){h(n,s(n))})}function rt(){i.toggleClass("fg-picker-lg");l()}function ut(){i&&t.options.fx&&!t.options.fxmobile&&(n(window).width()<480?i.removeClass("fg-picker-fxs"):i.addClass("fg-picker-fxs"))}function ui(){return!0}function s(n){switch(n){case"d":return r.date();case"m":return r.month()+1;case"y":return r.year()}}function ft(n,t){for(var r=[],i=e[n].min;i<=e[n].max;i++)i%t==0&&r.push(i);return r}function fi(n,t){for(var u,r=t[0],f=Math.abs(n-r),i=0;i<t.length;i++)u=Math.abs(n-t[i]),u<f&&(f=u,r=t[i]);return r}function a(n){return i.find('ul.pick[data-k="'+n+'"]')}function c(t,i){var r=[];return a(t).find("li").each(function(){r.push(n(this).attr("value"))}),i==="last"?r[r.length-1]:r[0]}function v(){return t.options.style||"s"}function y(n){var i=f.format("ll");t.$elem.val(i);n&&t.$elem.change()}var t={},i,o=!1,u,p,f,r,w,b,k=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),e={d:{min:1,max:31},m:{min:1,max:12},y:{min:1,max:9999}};return t.getYear=function(){return f.year()},t.setYear=function(n){f.year(n)},t.getMonth=function(){return f.month()},t.setMonth=function(n){f.month(n)},t.getDate=function(){return f.date()},t.setDate=function(n){f.date(n)},t.from=function(n){f=moment(n);f.locale(t.options.locale);y(!1)},t.init=function(i,r){if(t.$elem=n(r),t.options=n.extend({},n.fn.fgDateDropper.options,i),w=moment(t.options.min||{year:2e3},null,t.options.locale),b=moment(t.options.max||{year:2050},null,t.options.locale),e.y.min=w.year(),e.y.max=b.year(),e.y.min>e.y.max)throw new Error("Invalid min-max bounds.");if(e.y.max-e.y.max>200)throw new Error("Cannot span more than 200 years.");t.$elem.prop({readonly:!0}).addClass("fg-date-input");t.$elem.focus(function(n){n.preventDefault();t.$elem.blur()});t.$elem.click(function(){ti()});f=moment();f.locale(t.options.locale);y(!1)},t}n.fn.fgDateDropper=function(i){return this.each(function(){var r=t();r.init(i,this);n(this).data("fgDateDropper",r)})};n.fn.fgDateDropper.options={locale:null,modal:!0,style:"sl",fx:!0,fxmobile:!0,title:null}})(jQuery);